{"version":3,"file":"database.js","sourceRoot":"","sources":["../../src/utils/database.ts"],"names":[],"mappings":"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","sourcesContent":["import initSqlJs from 'sql.js';\nimport { EventEmitter } from '@stencil/core';\n\nimport { SQLiteSet, JsonSQLite, SQLiteVersionUpgrade, JsonProgressListener} from '../interfaces/interfaces';\n\nimport { UtilsStore } from './utils-store';\nimport { UtilsImportJSON } from './utils-importJson';\nimport { UtilsJSON } from './utils-json';\nimport { UtilsExportJSON } from './utils-exportJson';\nimport { UtilsUpgrade }  from './utils-upgrade';\nimport { UtilsSQLite } from './utils-sqlite'\n\nexport class Database {\n  private _isDBOpen: boolean;\n  private dbName: string;\n  private store: any;\n  private version: number;\n  public mDb: any;\n  private vUpgDict: Record<number, SQLiteVersionUpgrade> = {};\n  private autoSave: boolean = false;\n  private wasmPath: string = '/assets';\n  private isBackup: boolean = false;\n  private isTransactionActive: boolean = false;\n\n\n  constructor(databaseName: string, version: number,\n              upgDict: Record<number, SQLiteVersionUpgrade>,\n              store: LocalForage, autoSave: boolean, wasmPath: string) {\n    this.dbName = databaseName;\n    this.store = store;\n    this.version = version;\n    this.mDb = null;\n    this.vUpgDict = upgDict;\n    this._isDBOpen = false;\n    this.autoSave = autoSave;\n    this.wasmPath = wasmPath;\n  }\n  public async open(): Promise<void> {\n    const config ={\n      locateFile: (file: any) => `${this.wasmPath}/${file}`\n    }\n\n    return new Promise((resolve,reject) => {\n      try {\n        initSqlJs(config).then(async (SQL) => {\n          // retrieve the database if stored on localforage\n          const retDB: Uint8Array = await UtilsStore.getDBFromStore(this.dbName, this.store);\n          if(retDB != null) {\n            // Open existing database\n            this.mDb = new SQL.Database(retDB);\n          } else {\n            // Create a new database\n            this.mDb = new SQL.Database();\n            await UtilsStore.setInitialDBToStore( this.dbName, this.store);\n          }\n\n          this._isDBOpen = true;\n          // get the current version\n          let curVersion: number = await UtilsSQLite.getVersion(this.mDb);\n          if (this.version > curVersion && (Object.keys(this.vUpgDict)).length > 0) {\n            try {\n              // copy the db\n              const isDB: boolean = await UtilsStore.isDBInStore(this.dbName, this.store);\n              if (isDB) {\n                await UtilsStore.copyDBToStore(this.dbName, `backup-${this.dbName}`, this.store);\n                this.isBackup = true;\n              }\n\n              // execute the upgrade flow process\n              const changes: number = await UtilsUpgrade.onUpgrade(\n                                      this,\n                                      this.vUpgDict,\n                                      curVersion,\n                                      this.version\n              );\n              if(changes === -1) {\n                // restore the database from backup\n                try {\n                  if(this.isBackup) {\n                    await UtilsStore.restoreDBFromStore(this.dbName, 'backup',this.store);\n                  }\n                } catch (err:any) {\n                  const msg = err.message ? err.message : err;\n                  return reject(new Error(`Open: ${msg}`));\n                }\n              }\n              // delete the backup database\n              if(this.isBackup) {\n                await UtilsStore.removeDBFromStore(`backup-${this.dbName}`,this.store);\n              }\n\n\n            } catch (err) {\n              // restore the database from backup\n              try {\n                if(this.isBackup) {\n                  await UtilsStore.restoreDBFromStore(this.dbName, 'backup',this.store);\n                }\n              } catch (err: any) {\n                const msg = err.message ? err.message : err;\n                return reject(new Error(`Open: ${msg}`));\n              }\n            }\n\n          }\n          if( this.autoSave ) {\n            try {\n              await this.saveToStore();\n            } catch (err: any) {\n              this._isDBOpen = false;\n              const msg = err.message ? err.message : err;\n              return reject(new Error(`Open: ${msg}`));\n            }\n          }\n          // set Foreign Keys On\n          await UtilsSQLite.setForeignKeyConstraintsEnabled(this.mDb, true);\n\n          return resolve();\n        });\n      } catch (err: any) {\n        this._isDBOpen = false;\n        const msg = err.message ? err.message : err;\n        return reject(new Error(`Open: ${msg}`));\n      }\n\n    });\n  }\n  public isDBOpen(): boolean {\n    return this._isDBOpen;\n  }\n  public async close(): Promise<void> {\n    if (this.mDb != null && this._isDBOpen) {\n      try {\n        // save the database to store\n        await this.saveToStore(false);\n        // close the database\n        this.mDb.close();\n        this._isDBOpen = false;\n\n\n      } catch (err: any) {\n        this._isDBOpen = false;\n        const msg = err.message ? err.message : err;\n        return Promise.reject(new Error(`in close ${msg}`));\n      }\n    }\n    return Promise.resolve();\n  }\n  public async saveToStore(setFK:boolean = true): Promise<void> {\n    if (this.mDb != null && this._isDBOpen) {\n      try {\n        // save the database to store\n        await UtilsStore.setDBToStore(this.mDb, this.dbName, this.store);\n        if(setFK) {\n          // set Foreign Keys On\n          await UtilsSQLite.setForeignKeyConstraintsEnabled(this.mDb, true);\n        }\n      } catch (err: any) {\n        const msg = err.message ? err.message : err;\n        return Promise.reject(new Error(`in saveToStore ${msg}`));\n      }\n    }\n    return Promise.resolve();\n  }\n  public async exportDB(): Promise<Uint8Array> {\n    // export the database\n    try {\n      const data: Uint8Array = this.mDb.export();\n      return data;\n    } catch (err: any) {\n      const msg = err.message ? err.message : err;\n      return Promise.reject(new Error(`exportDB: ${msg}`));\n    }\n\n  }\n  public async getVersion(): Promise<number> {\n    if (this.mDb != null && this._isDBOpen) {\n      try {\n        // save the database to store\n        const curVersion: number = await UtilsSQLite.getVersion(this.mDb)\n        return Promise.resolve(curVersion);\n      } catch (err: any) {\n        this._isDBOpen = false;\n        const msg = err.message ? err.message : err;\n        return Promise.reject(new Error(`in getVersion ${msg}`));\n      }\n    }\n  }\n\n  public async isDBExists(database: string): Promise<boolean> {\n    try {\n      const isExists: boolean = await UtilsStore.isDBInStore(database, this.store);\n      return Promise.resolve(isExists);\n    } catch (err: any) {\n      const msg = err.message ? err.message : err;\n      return Promise.reject(new Error(`in isDBExists ${msg}`));\n    }\n  }\n  public async deleteDB(database: string): Promise<void> {\n    try {\n      // test if file exists\n      const isExists: boolean = await this.isDBExists(database);\n      if (isExists && !this._isDBOpen) {\n        // open the database\n          await this.open();\n      }\n      // close the database\n      await this.close();\n      // delete the database\n      if (isExists) {\n        await UtilsStore.removeDBFromStore(database, this.store);\n      }\n      return Promise.resolve();\n    } catch (err: any) {\n      const msg = err.message ? err.message : err;\n      return Promise.reject(new Error(`DeleteDB: ${msg}`));\n    }\n\n  }\n  public async beginTransaction(): Promise<number> {\n    if (!this._isDBOpen) {\n      let msg = `BeginTransaction: Database ${this.dbName} `;\n      msg += `not opened`;\n      return Promise.reject(new Error(msg));\n    }\n    try {\n      await UtilsSQLite.beginTransaction(this.mDb, true);\n      this.setIsTransActive(true);\n      return 0;\n    } catch(err: any) {\n      let msg = `BeginTransaction: ${err.message ? err.message : err}`;\n      return Promise.reject(new Error(`${msg}`));\n    }\n\n  }\n  public async commitTransaction(): Promise<number> {\n    if (!this._isDBOpen) {\n      let msg = `CommitTransaction: Database ${this.dbName} `;\n      msg += `not opened`;\n      return Promise.reject(new Error(msg));\n    }\n    try {\n      await UtilsSQLite.commitTransaction(this.mDb, true);\n      this.setIsTransActive(false);\n      return 0\n    } catch(err: any) {\n      let msg = `CommitTransaction: ${err.message ? err.message : err}`;\n      return Promise.reject(new Error(`${msg}`));\n    }\n\n  }\n  public async rollbackTransaction(): Promise<number> {\n    if (!this._isDBOpen) {\n      let msg = `RollbackTransaction: Database ${this.dbName} `;\n      msg += `not opened`;\n      return Promise.reject(new Error(msg));\n    }\n    try {\n      await UtilsSQLite.rollbackTransaction(this.mDb, true);\n      this.setIsTransActive(false);\n      return 0\n    } catch(err: any) {\n      let msg = `RollbackTransaction: ${err.message ? err.message : err}`;\n      return Promise.reject(new Error(`${msg}`));\n    }\n\n  }\n  public isTransActive(): boolean {\n    return this.isTransactionActive;\n  }\n  public setIsTransActive(value: boolean) {\n    this.isTransactionActive = value;\n  }\n  public async executeSQL(sql: string, transaction: boolean = true): Promise<number> {\n    if (!this._isDBOpen) {\n      let msg = `ExecuteSQL: Database ${this.dbName} `;\n      msg += `not opened`;\n      return Promise.reject(new Error(msg));\n    }\n    let initChanges = -1;\n    try {\n      initChanges = await UtilsSQLite.dbChanges(this.mDb);\n      if(transaction && !this.isTransactionActive ) {\n        await this.beginTransaction();\n      }\n    } catch(err: any) {\n      let msg = `executeSQL: ${err.message ? err.message : err}`;\n      return Promise.reject(new Error(`${msg}`));\n    }\n    try {\n      const mChanges = await UtilsSQLite.execute(this.mDb, sql, false);\n      if (mChanges < 0) {\n        return Promise.reject(new Error('ExecuteSQL: changes < 0'));\n      }\n      if(transaction && this.isTransactionActive) {\n        await this.commitTransaction();\n      }\n      const changes = (await UtilsSQLite.dbChanges(this.mDb)) - initChanges;\n      return Promise.resolve(changes);\n    } catch (err: any) {\n      let msg = `ExecuteSQL: ${err.message ? err.message : err}`;\n      try {\n        if(transaction && this.isTransactionActive) await this.rollbackTransaction();\n      } catch (err: any) {\n        msg += ` : ${err.message ? err.message : err}`;\n      }\n      return Promise.reject(new Error(`ExecuteSQL: ${msg}`));\n    } finally {\n      if(transaction) this.isTransactionActive = false;\n      if( this.autoSave && ! this.isTransactionActive) {\n        try {\n          await this.saveToStore();\n        } catch (err: any) {\n          this._isDBOpen = false;\n          const msg = err.message ? err.message : err;\n          return Promise.reject(`ExecuteSQL: ${msg}`);\n        }\n      }\n\n    }\n  }\n  public async execSet(set: SQLiteSet[], transaction: boolean = true, returnMode ='no'): Promise<any> {\n    if (!this._isDBOpen) {\n      let msg = `ExecSet: Database ${this.dbName} `;\n      msg += `not opened`;\n      return Promise.reject(new Error(msg));\n    }\n    const retRes: any = { changes: -1, lastId: -1 };\n    let initChanges = -1;\n    try {\n      initChanges = await UtilsSQLite.dbChanges(this.mDb);\n      if(transaction && !this.isTransactionActive) {\n        await this.beginTransaction();\n      }\n    } catch(err: any) {\n      const msge = err.message ? err.message : err;\n      let msg = `ExecSet: ${msge}`;\n      return Promise.reject(new Error(`${msg}`));\n    }\n    try {\n      const retObj: any = await UtilsSQLite.executeSet(this.mDb, set, false, returnMode);\n      let lastId: number = retObj[\"lastId\"];\n      if (lastId < 0) {\n        return Promise.reject(new Error('ExecSet: changes < 0'));\n      }\n      if(transaction && this.isTransactionActive) await this.commitTransaction();\n      const changes = (await UtilsSQLite.dbChanges(this.mDb)) - initChanges;\n      retRes.changes = changes;\n      retRes.lastId = lastId;\n      retRes.values = retObj[\"values\"] ? retObj[\"values\"] : []\n      return Promise.resolve(retRes);\n    } catch (err: any) {\n      const msge = err.message ? err.message : err;\n      let msg = `ExecSet: ${msge}`;\n      try {\n        if(transaction && this.isTransactionActive) await this.rollbackTransaction();\n      } catch (err: any) {\n        msg += ` : ${err.message ? err.message : err}`;\n      }\n      return Promise.reject(new Error(`ExecSet: ${msg}`));\n    } finally {\n      if(transaction) this.isTransactionActive = false;\n      if( this.autoSave  && ! this.isTransactionActive) {\n        try {\n          await this.saveToStore();\n        } catch (err: any) {\n          const msg = err.message ? err.message : err;\n          this._isDBOpen = false;\n          return Promise.reject(`ExecSet: ${msg}`);\n        }\n      }\n    }\n  }\n  public async selectSQL(sql: string, values: string[]): Promise<any[]> {\n    if (!this._isDBOpen) {\n      let msg = `SelectSQL: Database ${this.dbName} `;\n      msg += `not opened`;\n      return Promise.reject(new Error(msg));\n    }\n    try {\n      let retArr: any[] = await UtilsSQLite.queryAll(this.mDb, sql, values);\n      return Promise.resolve(retArr);\n    } catch (err: any) {\n      const msg = err.message ? err.message : err;\n      return Promise.reject(new Error(`SelectSQL: ${msg}`));\n    }\n  }\n  public async runSQL(statement: string, values: any[], transaction: boolean = true,\n                      returnMode: string): Promise<any> {\n    let lastId = -1;\n    if (!this._isDBOpen) {\n      let msg = `RunSQL: Database ${this.dbName} `;\n      msg += `not opened`;\n      return Promise.reject(new Error(msg));\n    }\n    const retRes: any = { changes: -1, lastId: -1 };\n    let initChanges = -1;\n    try {\n      initChanges = await UtilsSQLite.dbChanges(this.mDb);\n\n      if(transaction && !this.isTransactionActive) {\n        await this.beginTransaction();\n      }\n     } catch(err: any) {\n      const msge = err.message ? err.message : err;\n      let msg = `RunSQL: ${msge}`;\n      return Promise.reject(new Error(`${msg}`));\n    }\n    try {\n      const retObj = await UtilsSQLite.run(this.mDb, statement, values, false, returnMode);\n      lastId = retObj[\"lastId\"];\n      if (lastId < 0) {\n        return Promise.reject(new Error('RunSQL: lastId < 0'));\n      }\n      if(transaction && this.isTransactionActive) {\n         await this.commitTransaction();\n      }\n      const changes = (await UtilsSQLite.dbChanges(this.mDb)) - initChanges;\n      retRes.changes = changes;\n      retRes.lastId = lastId;\n      retRes.values = retObj[\"values\"] ? retObj[\"values\"] : []\n\n      return Promise.resolve(retRes);\n    } catch (err: any) {\n      const msge = err.message ? err.message : err;\n      let msg = `RunSQL: ${msge}`;\n      try {\n        if(transaction && this.isTransactionActive) {\n          await this.rollbackTransaction();\n        }\n      } catch (err: any) {\n        msg += ` : ${err.message ? err.message : err}`;\n      }\n      return Promise.reject(new Error(`${msg}`));\n    } finally {\n      if(transaction) this.setIsTransActive(false);\n      if( this.autoSave  && ! this.isTransactionActive) {\n        try {\n          await this.saveToStore();\n        } catch (err: any) {\n          this._isDBOpen = false;\n          const msg = err.message ? err.message : err;\n          return Promise.reject(`ExecSet: ${msg}`);\n        }\n      }\n    }\n  }\n  async getTableNames(): Promise<any[]> {\n    if (!this._isDBOpen) {\n      let msg = `GetTableNames: Database ${this.dbName} `;\n      msg += `not opened`;\n      return Promise.reject(new Error(msg));\n    }\n    try {\n      let retArr: any[] = await UtilsSQLite.getTableList(this.mDb);\n      return Promise.resolve(retArr);\n    } catch (err: any) {\n      const msg = err.message ? err.message : err;\n      return Promise.reject(new Error(`GetTableNames: ${msg}`));\n    }\n\n  }\n  async isTable(tableName: string): Promise<boolean> {\n    if (!this._isDBOpen) {\n      let msg = `isTable: Database ${this.dbName} `;\n      msg += `not opened`;\n      return Promise.reject(new Error(msg));\n    }\n    try {\n      const retB = await UtilsSQLite.isTableExists(this.mDb, tableName);\n      return Promise.resolve(retB);\n    } catch (err: any) {\n      const msg = `IsTable: ${err.message ? err.message : err}`;\n      return Promise.reject(new Error(msg));\n    }\n  }\n  async createSyncTable(): Promise<number> {\n    if (!this._isDBOpen) {\n      let msg = `createSyncTable: Database ${this.dbName} `;\n      msg += `not opened`;\n      return Promise.reject(new Error(msg));\n    }\n    let changes = -1;\n    try {\n      const retB = await UtilsSQLite.isTableExists(this.mDb, 'sync_table');\n      if(!retB) {\n        const isLastMod = await UtilsSQLite.isLastModified(this.mDb, this._isDBOpen);\n        const isDel = await UtilsSQLite.isSqlDeleted(this.mDb, this._isDBOpen);\n        if(isLastMod && isDel) {\n          const date: number = Math.round(new Date().getTime() / 1000);\n          let stmts = `\n                          CREATE TABLE IF NOT EXISTS sync_table (\n                              id INTEGER PRIMARY KEY NOT NULL,\n                              sync_date INTEGER\n                              );`;\n          stmts += `INSERT INTO sync_table (sync_date) VALUES (\n                              \"${date}\");`;\n          changes = await UtilsSQLite.execute(this.mDb, stmts, false);\n          return Promise.resolve(changes);\n        } else {\n          return Promise.reject(new Error('No last_modified/sql_deleted columns in tables'));\n        }\n      } else {\n        return Promise.resolve(0);\n      }\n    } catch (err: any) {\n      const msge = err.message ? err.message : err;\n      const msg = `CreateSyncTable: ${msge}`;\n      return Promise.reject(new Error(msg));\n    }\n  }\n  async getSyncDate(): Promise<number> {\n    if (!this._isDBOpen) {\n      let msg = `getSyncDate: Database ${this.dbName} `;\n      msg += `not opened`;\n      return Promise.reject(new Error(msg));\n    }\n    try {\n      const isTable = await UtilsSQLite.isTableExists(this.mDb, 'sync_table');\n      if(!isTable) {\n        return Promise.reject(new Error('No sync_table available'));\n      }\n      const res = await UtilsExportJSON.getSynchroDate(this.mDb);\n      return Promise.resolve(res);\n    } catch (err: any) {\n      const msge = err.message ? err.message : err;\n      const msg = `getSyncDate: ${msge}`;\n      return Promise.reject(new Error(msg));\n    }\n  }\n  async setSyncDate(syncDate: string): Promise<any> {\n    if (!this._isDBOpen) {\n      let msg = `SetSyncDate: Database ${this.dbName} `;\n      msg += `not opened`;\n      return { result: false, message: msg };\n    }\n    try {\n      const isTable = await UtilsSQLite.isTableExists(this.mDb, 'sync_table');\n      if(!isTable) {\n        return Promise.reject(new Error('No sync_table available'));\n      }\n      const sDate: number = Math.round(new Date(syncDate).getTime() / 1000);\n      let stmt = `UPDATE sync_table SET sync_date = `;\n      stmt += `${sDate} WHERE id = 1;`;\n      const changes: number = await UtilsSQLite.execute(this.mDb, stmt, false);\n      if (changes < 0) {\n        return { result: false, message: 'setSyncDate failed' };\n      } else {\n        return { result: true };\n      }\n    } catch (err: any) {\n      const msg = err.message ? err.message : err;\n      return { result: false, message: `setSyncDate failed: ${msg}` };\n    }\n  }\n  async importJson(jsonData: JsonSQLite, importProgress: EventEmitter<JsonProgressListener>): Promise<any> {\n    let changes = 0;\n    if (this._isDBOpen) {\n      try {\n        // set Foreign Keys Off\n        await UtilsSQLite.setForeignKeyConstraintsEnabled(this.mDb, false);\n\n        if (jsonData.tables && jsonData.tables.length > 0) {\n\n          // create the database schema\n          changes = await UtilsImportJSON.createDatabaseSchema(this, jsonData);\n          let msg = `Schema creation completed changes: ${changes}`;\n          importProgress.emit({progress:msg});\n\n          if (changes != -1) {\n            // create the tables data\n            changes += await UtilsImportJSON.createTablesData(this, jsonData, importProgress);\n            let msg = `Tables data creation completed changes: ${changes}`;\n            importProgress.emit({progress:msg});\n          }\n        }\n        if (jsonData.views && jsonData.views.length > 0) {\n          // create the views\n          changes += await UtilsImportJSON.createViews(this, jsonData);\n        }\n        // set Foreign Keys On\n        await UtilsSQLite.setForeignKeyConstraintsEnabled(this.mDb, true);\n\n        await this.saveToStore();\n\n        return Promise.resolve(changes);\n      } catch (err: any) {\n        const msg = err.message ? err.message : err;\n        return Promise.reject(new Error(`ImportJson: ${msg}`));\n      }\n    } else {\n      return Promise.reject(new Error(`ImportJson: database is closed`));\n    }\n  }\n  async exportJson(mode: string, exportProgress: EventEmitter<JsonProgressListener>): Promise<any> {\n    const inJson: JsonSQLite = {} as JsonSQLite;\n    inJson.database = this.dbName.slice(0, -9);\n    inJson.version = this.version;\n    inJson.encrypted = false;\n    inJson.mode = mode;\n    if (this._isDBOpen) {\n      try {\n        const isTable = await UtilsSQLite.isTableExists(this.mDb, 'sync_table');\n        if(isTable) {\n          await UtilsExportJSON\n                  .setLastExportDate(this.mDb, (new Date()).toISOString());\n        } else {\n          if(inJson.mode !== 'full') {\n            const msg = `No sync_table available for partial mode`;\n            return Promise.reject(new Error(msg));\n          }\n        }\n        const retJson: JsonSQLite = await UtilsExportJSON\n                      .createExportObject(this.mDb, inJson, exportProgress);\n        const keys = Object.keys(retJson);\n        if(keys.length === 0) {\n          const msg = `ExportJson: return Object is empty `+\n                      `No data to synchronize`;\n          return Promise.reject(new Error(msg));\n        }\n        const isValid = UtilsJSON.isJsonSQLite(retJson);\n        if (isValid) {\n          return Promise.resolve(retJson);\n        } else {\n          return Promise.reject(new Error(`ExportJson: retJson not valid`));\n        }\n      } catch (err: any) {\n        const msg = err.message ? err.message : err;\n        return Promise.reject(new Error(`ExportJson: ${msg}`));\n      }\n    } else {\n      return Promise.reject(new Error(`ExportJson: database is closed`));\n    }\n  }\n  async deleteExportedRows() : Promise<void> {\n    if (this._isDBOpen) {\n      try {\n        await UtilsExportJSON.delExportedRows(this.mDb);\n        return Promise.resolve();\n      } catch (err: any) {\n        const msg = err.message ? err.message : err;\n        return Promise.reject(new Error(`deleteExportedRows: ${msg}`));\n      }\n    } else {\n      return Promise.reject(new Error(`deleteExportedRows: database is closed`));\n    }\n\n  }\n}\n"]}